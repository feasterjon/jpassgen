(()=>{"use strict";class e{toggle(e){const t=document.querySelectorAll(e+", #"+e+", ."+e)[0];"none"===t.style.display?t.style.display="":t.style.display="none"}}class t{blur(e,t){const s=document.querySelectorAll(e+", #"+e+", ."+e)[0];s.addEventListener?s.addEventListener("blur",t):s.attachEvent&&s.attachEvent("onblur",t)}change(e,t){const s=document.querySelectorAll(e+", #"+e+", ."+e)[0];s.addEventListener?s.addEventListener("change",t):s.attachEvent&&s.attachEvent("onchange",t)}click(e,t){const s=document.querySelectorAll(e+", #"+e+", ."+e)[0];s.addEventListener?s.addEventListener("click",t):s.attachEvent&&s.attachEvent("onclick",t)}}class s{copyClip(e,t,s,a){const i=document.querySelectorAll(e+", #"+e+", ."+e)[0];i.select(),i.setSelectionRange(0,99999),navigator.clipboard.writeText(i.value),this.feedback(t,s,a)}feedback(e,t,s=1e3){const a=document.querySelectorAll(e+", #"+e+", ."+e)[0];if(a){let e=a.textContent,i=!!e;i||(e=a.value),a.disabled=!0,t&&(!0===i?a.textContent=t:a.value=t),a.focus(),setTimeout((()=>{!0===i?a.textContent=e:a.value=e,a.disabled=!1}),s)}}}class a{validate(e,t){let s=!1;if(t){let a=t.length;for(let i=0;i<a;i++)if(e.indexOf(t.charAt(i))>=0){s=!0;break}}else s=!0;return s}generate(e,t){let s="";if(e=Math.abs(parseInt(e)),Number.isInteger(e)&&t)for(let a=0;a<e;a++)s+=t.charAt(Math.floor(Math.random()*t.length));return s}}class i{constructor(e){if(this.data=e,this.database=this.data.name,this.persistence=this.data.persistence,this.cookieStorage=this.data.cookieStorage,this.reset=this.data.reset,this.persistentExpiry=36500,this.lsSupport=!1,"undefined"!=typeof Storage)try{sessionStorage.setItem("sessionStorage","true"),this.lsSupport=!0}catch(e){}this.cookieStorage&&(this.lsSupport=!1),this.reset&&(this.destroy(),this.destroyCookie())}store(e,t,s){this.persistence&&(s=this.persistentExpiry),this.lsSupport?s&&s>0?localStorage.setItem(e,t):sessionStorage.setItem(e,t):s?this.storeCookie(e,t,s):this.storeCookie(e,t)}storeField(e,t,s){let a=this.read(this.database),i={};this.validateJSON(a)&&(i=JSON.parse(a)),i[e]=t,i=JSON.stringify(i),this.store(this.database,i,s)}read(e){let t;return this.lsSupport?localStorage.getItem(e)?t=localStorage.getItem(e):sessionStorage.getItem(e)&&(t=sessionStorage.getItem(e)):this.readCookie(e)&&(t=this.readCookie(e)),t}readField(e){let t=this.read(this.database);return this.validateJSON(t)?(t=JSON.parse(t),t[e]):t}destroy(e){this.lsSupport?e?(localStorage.removeItem(e),sessionStorage.removeItem(e)):(localStorage.clear(),sessionStorage.clear()):this.destroyCookie(e)}destroyField(e){if(e){let t,s=this.read(this.database);this.validateJSON(s)?(t=JSON.parse(s),delete t[e],t=JSON.stringify(t),sessionStorage.getItem(this.database)?this.store(this.database,t):(localStorage.getItem(this.database),this.store(this.database,t,this.persistentExpiry))):this.destroy(e)}else this.destroy()}storeCookie(e,t,s){t=encodeURIComponent(t);let a=new Date;a.setTime(a.getTime()+24*s*60*60*1e3);let i="; expires="+a.toGMTString();document.cookie=e+"="+t+i+"; path=/"}readCookie(e){let t=null,s=e+"=",a=document.cookie.split(";");for(let e=0,i=a.length;e<i;e++){let i=a[e];for(;" "===i.charAt(0);)i=i.substring(1,i.length);0===i.indexOf(s)&&(t=decodeURIComponent(i.substring(s.length,i.length)))}return t}destroyCookie(e){if(e)this.storeCookie(e,"",-1);else{let e=document.cookie.split(";"),t=e.length;for(let s=0;s<t;s++){let t=e[s],a=t.indexOf("="),i=a>-1?t.substr(0,a):t;document.cookie=i+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}}}validateJSON(e){let t=!1;if(e)try{JSON.parse(e),t=!0}catch(e){}return t}}class l{constructor(l){this.data=l.data[0].attributes,this.effects=new e,this.events=new t,this.interaction=new s,this.jPassGen=new a,this.localData=new i(this.data.localData)}render(){if(this.data){if(document.body.innerHTML=document.getElementById(this.data.templateId).innerHTML,this.events.click(this.data.templateButtons.submitId,(()=>{this.gen()})),this.events.click(this.data.templateButtons.copyId,(()=>{this.interaction.copyClip(this.data.outputId,this.data.templateButtons.copyId,"Copied")})),this.events.click(this.data.templateButtons.resetId,(()=>{this.reset()})),!0===this.data.enableHelp&&(document.getElementById(this.data.helpContentId).style.display="none",this.events.click(this.data.templateButtons.helpId,(()=>{this.effects.toggle(this.data.helpContentId)}))),this.localData.readField(this.data.saveId)){let e,t=Object.values(this.data.templateFields);for(let s of t)e=this.localData.readField(s),"undefined"!==e&&(document.getElementById(s).value=e);document.getElementById(this.data.saveId).checked=!0}if(!0===this.data.autoStart&&this.gen(),!0===this.data.enableCreds){try{document.getElementById("description").innerHTML=document.getElementsByName("description")[0].getAttribute("content")}catch(e){}try{document.getElementById("author").innerHTML=document.getElementsByName("author")[0].getAttribute("content")}catch(e){}}}}removeSpaces(e){let t="";return e&&(t=e.replace(/\s/g,"")),t}reset(){let e=Object.values(this.data.templateFields);for(let t of e)this.localData.destroyField(t),document.getElementById(t).value=document.getElementById(t).defaultValue;this.localData.destroyField(this.data.saveId),document.getElementById(this.data.saveId).checked=document.getElementById(this.data.saveId).defaultChecked,document.getElementById(this.data.outputId).value=document.getElementById(this.data.outputId).defaultValue,document.getElementById(this.data.templateButtons.submitId).focus()}gen(){let e="",t="",s=document.getElementById(this.data.templateFields.lengthId).value,a=document.getElementById(this.data.templateFields.lettersLowerId).value,i=document.getElementById(this.data.templateFields.lettersUpperId).value,l=document.getElementById(this.data.templateFields.numbersId).value,o=document.getElementById(this.data.templateFields.symbolsId).value,d=document.getElementById(this.data.templateFields.amountId).value,n=document.getElementById(this.data.saveId).checked;if(s>=5&&(""!==a||""!==i||""!==l||""!==o)&&d>=1){a=this.removeSpaces(a),i=this.removeSpaces(i),l=this.removeSpaces(l),o=this.removeSpaces(o);let r=a+i+l+o;for(let n=0;n<d;n++){for(e=this.jPassGen.generate(s,r);!1===this.jPassGen.validate(e,a)||!1===this.jPassGen.validate(e,i)||!1===this.jPassGen.validate(e,l)||!1===this.jPassGen.validate(e,o);)e=this.jPassGen.generate(s,r);0===n?t=e:t+="\r"+e}if(!0===n){let e=Object.values(this.data.templateFields);for(let t of e)this.localData.storeField(t,document.getElementById(t).value);this.localData.storeField(this.data.saveId,n)}}else alert("Error: One or more fields contains an invalid value.");document.getElementById(this.data.outputId).value=t,document.getElementById(this.data.outputId).select()}}(new class{async load(){let e=await fetch("assets/api/config.json");if(200===e.status){let t=await e.json();new l(t).render()}}}).load()})();