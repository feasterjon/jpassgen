<!DOCTYPE html>
<html lang="en">
  <head>
    <title>JPassword Generator</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1" />
    <meta name="description" content="JPassword Generator (Ver. 5.0.0)" />
    <meta name="keywords" content="password, generator, information, security, randomizer, authentication, infosec" />
    <meta name="author" content="Jonathan Feaster" />
    <!--[if lt IE 11]>
      <meta http-equiv="x-ua-compatible" content="IE=edge" />
    <![endif]-->
    <!-- Author : Jonathan Feaster, Bit Designer -->
    <style>
    
      html {
        font-size: 100%;
      }
    
      body {
        font-family: Arial, Helvetica, sans-serif;
        font-size: 1.2em;
      }
      
      h1 {
        font-size: 1.4em;
        border-bottom-width: 0.0625em;
        border-bottom-style: solid;
        border-bottom-color: rgb(192, 192, 192);
        border-bottom-color: rgba(0, 0, 0, 0.25);
      }
      
      div {
        padding: 0.5em;
      }
      
      header, footer, #app, #help {
        margin: auto;
        width: 60%;
      }
      
      footer {
        font-size: 0.833em;
        text-align: center;
        border-top-width: 0.0625em;
        border-top-style: solid;
        border-top-color: rgb(192, 192, 192);
        border-top-color: rgba(0, 0, 0, 0.25);
      }
      
      .i {
        font-style: italic;
      }
      
      #app {
        text-align: center;
      }
      
      label {
        width: 30%;
      }
      
      label:after {
        content: "\003a\00a0";
      }
      
      #length, #letters-lower, #letters-upper, #numbers, #symbols, #amount {
        width: 65%;
      }
      
      #output {
        width: 100%;
        height: 10em;
      }
      
      #button-generate {
        width: 30%;
      }
      
      #button-reset {
        width: 30%;
      }
      
      #button-help {
        width: 30%;
      }
      
      /* Table */
      
      table {
        padding: 1em;
        text-align: left;
        width: 100%;
        height: auto;
        border-width: 0.0625em;
        border-style: solid;
        border-color: rgb(192, 192, 192);
        border-color: rgba(0, 0, 0, 0.25);
        border-collapse: collapse;
      }
      
      table caption, th, td {
        padding: 0.5em;
      }
      
      caption,th {
        font-weight: bold;
      }
      
      th {
        background-color: rgb(192, 192, 192);
        background-color: rgba(0, 0, 0, 0.25);
      }
      
      th, td {
        border-width: 0.0625em;
        border-style: solid;
        border-color: rgb(192, 192, 192);
        border-color: rgba(0, 0, 0, 0.25);
      }
      
      #help {
        display: none;
      }
      
    </style>
  </head>
  <body>
    <p><strong>Loading&#8230;</strong></p>
    <noscript><p><strong>JavaScript is required to access this resource.</strong></p></noscript>
    <script id="template" class="template" type="text/template">
      <header><h1>JPassword Generator</h1></header>
      <div id="main">
        <section>
          <article id="app">
            <div><label for="length">Length</label><input type="number" id="length" name="length" value="10" /></div>
            <div><label for="letters-lower">Lowercase Letters</label><input type="text" id="letters-lower" name="letters-lower" value="abcdefghijklmnopqrstuvwxyz" /></div>
            <div><label for="letters-upper">Uppercase Letters</label><input type="text" id="letters-upper" name="letters-upper" value="ABCDEFGHIJKLMNOPQRSTUVWXYZ" /></div>
            <div><label for="numbers">Numbers</label><input type="text" id="numbers" name="numbers" value="0123456789" /></div>
            <div><label for="symbols">Symbols</label><input type="text" id="symbols" name="symbols" value="~!@#$%^&*()-_+={}[]|;:<>,./?" /></div>
            <div><label for="amount">Amount</label><input type="number" id="amount" name="amount" value="1" /></div>
            <div><label for="save">Save Settings</label><input type="checkbox" id="save" name="save" value="save" /></div>
            <div>
              <button id="button-generate">Generate</button>
              <button id="button-reset">Reset</button>
              <button id="button-help">Help</button>
            </div>
            <div><label for="output" class="output">Password(s)</label><textarea id="output" name="output" readonly="readonly"></textarea></div>
            <p><strong>Note:</strong> Password data will not be stored on a server and is only processed in the browser.</p>
          </article>
          <article id="help">
            <h1>Help</h1>
            <p>Strong passwords should be long and complex. Use the entire keyboard, incorporating numbers, symbols (~!@#$%^&*()-_+={}[]|;:<>,./?), and both lowercase and uppercase letters. The longer, the better. A minimum of eight characters is recommended. Do not use personal information like a dog's name or graduation year. Do not make your password identical to your username or email.</p>
          </article>
        </section>
      </div>
      <footer><p><span id="description"></span> Copyright &#169; <span id="author"></span></p></footer>
    </script>
    <script>

    <!--

    /*
    Main
    Updated: 2021-08-23
    */

    window.main = window.main || {}; // namespace
    
    main.App = (function() { // class
      
      'use strict';
      
      // init
      function init(params) {
        
        if (typeof params !== 'undefined') {
          document.body.innerHTML = document.getElementById(params.templateId).innerHTML;
          main.Events.click(params.templateButtons.submitId, gen);
          main.Events.click(params.templateButtons.resetId, reset);
          main.Events.click(params.templateButtons.helpId, function() {
            main.Effects.toggle(params.helpContentId);
          });
          if (typeof main.Data.read(params.databaseId + '-' + params.saveId) !== 'undefined') {
            let query;
            let values = Object.values(params.templateFields);
            for (let value of values) {
              query = main.Data.read(params.databaseId + '-' + value);
              if (typeof query !== 'undefined') {
                document.getElementById(value).value = query;
              }
            }
            document.getElementById(params.saveId).checked = true;
          }
          if (params.autoStart === true) {
            gen(); // generate random password
          }
          if (params.enableCreds === true) {
            try {
              document.getElementById('description').innerHTML = document.getElementsByName('description')[0].getAttribute('content');
            } catch(err) {}
            try {
              document.getElementById('author').innerHTML = document.getElementsByName('author')[0].getAttribute('content');
            } catch(err) {}
          }
        }
      }
      
      // remove spaces
      function removeSpaces(str) {
        
        let output = '';
        
        if (str) {
          output = str.replace(/\s/g, ''); // remove spaces
        }
        return output;
      }
      
      // validate
      function validate(str, strTest) {
      
        let output = false;
        
        if (strTest !== '') {
          for (let i = 0; i < strTest.length; i++) {
            if (str.indexOf(strTest.charAt(i)) >= 0) {
              output = true;
              break;
            }
          }
        }
        else {
          output = true;
        }
        return output;
      }
      
      // random password
      function randomPass(length, characters) {
      
        let output = '';
        
        length = Math.abs(parseInt(length)); // convert length to positive integer
        if (Number.isInteger(length) && characters !== '') {
          for (let i = 0; i < length; i++) {
            output += characters.charAt(Math.floor(Math.random() * characters.length));
          }
        }
        return output;
      }
      
      // reset
      function reset() {
        
        let values = Object.values(params.templateFields);
        for (let value of values) {
          main.Data.destroy(params.databaseId + '-' + value); // destroy templateFields in browser
          document.getElementById(value).value = document.getElementById(value).defaultValue;
        }
        main.Data.destroy(params.databaseId + '-' + params.saveId); // destroy save in browser
        document.getElementById(params.saveId).checked = document.getElementById(params.saveId).defaultChecked;
        document.getElementById(params.outputId).value = document.getElementById(params.outputId).defaultValue;
        document.getElementById(params.templateButtons.submitId).focus();
      }
      
      // generate random password
      function gen() {
        
        let password = "";
        let output = "";
        let length = document.getElementById(params.templateFields.lengthId).value;
        let lettersLower = document.getElementById(params.templateFields.lettersLowerId).value;
        let lettersUpper = document.getElementById(params.templateFields.lettersUpperId).value;
        let numbers = document.getElementById(params.templateFields.numbersId).value;
        let symbols = document.getElementById(params.templateFields.symbolsId).value;
        let amount = document.getElementById(params.templateFields.amountId).value;
        let save = document.getElementById(params.saveId).checked;
        
        if (length >= 5 && (lettersLower !== '' || lettersUpper !== '' || numbers !== '' || symbols !== '') && amount >= 1) {
          lettersLower = removeSpaces(lettersLower); // remove spaces
          lettersUpper = removeSpaces(lettersUpper); // remove spaces
          numbers = removeSpaces(numbers); // remove spaces
          symbols = removeSpaces(symbols); // remove spaces
          let characters = lettersLower+lettersUpper+numbers+symbols; // concatenate all characters
          for (let i = 0; i < amount; i++) { // iterate through amount
            password = randomPass(length, characters); // generate random password
            while (validate(password, lettersLower) === false || validate(password, lettersUpper) === false || validate(password, numbers) === false || validate(password, symbols) === false) {
              password = randomPass(length, characters); // generate random password
            }
            if (i === 0) {
              output = password;
            }
            else {
              output += "\r" + password;
            }
          }
          if (save === true) {
            let values = Object.values(params.templateFields);
            for (let value of values) {
              main.Data.store(params.databaseId + '-' + value, document.getElementById(value).value); // set templateFields in browser
            }
            main.Data.store(params.databaseId + '-' + params.saveId, save); // set save in browser
          }
        }
        else {
          alert('Error: One or more fields contains an invalid value.');
        }
        document.getElementById(params.outputId).value = output;
        document.getElementById(params.outputId).select();
      }

      return {
        init: init
      };

    })();
    
    main.Effects = (function() { // class
    
      // toggle
      function toggle(id) {
        
        const element = document.getElementById(id);
        
        if (element.style.display === 'block') {
          element.style.display = 'none';
        }
        else {
          element.style.display = 'block';
        }
      }
      
      return {
        toggle: toggle
      };
    
    })();
    
    main.Events = (function() { // class
      
      // change
      function change(id, eventObject) {
        
        const element = document.getElementById(id);
        
        if (element.addEventListener) {
          element.addEventListener('change', eventObject);
        }
        else if (element.attachEvent) {
          element.attachEvent('onchange', eventObject);
        }
      }
      
      // click
      function click(id, eventObject) {
        
        const element = document.getElementById(id);
        
        if (element.addEventListener) {
          element.addEventListener('click', eventObject);
        }
        else if (element.attachEvent) {
          element.attachEvent('onclick', eventObject);
        }
      }
      
      return {
        change: change,
        click: click
      };
    
    })();
    
    main.Data = (function() { // class
    
      // test
      function test() {
        if (typeof(Storage) !== 'undefined') {
          try {
            sessionStorage.setItem('sessionStorage', 'true');
            return true;
          }
          catch(err) {
            return false;
          }
        }
        else {
          return false;
        }
      }
      
      // store
      function store(key, value, expiry) {
        if (test() === true) {
          if (expiry) {
            sessionStorage.setItem(key, value);
          }
          else {
            localStorage.setItem(key, value);
          }
        }
      }
      
      // read
      function read(key) {
        if (test() === true) {
          if (sessionStorage.getItem(key)) {
            return sessionStorage.getItem(key);
          }
          else if (localStorage.getItem(key)) {
            return localStorage.getItem(key);
          }
        }
      }
      
      // destroy
      function destroy(key) {
        if (test() === true) {
          if (key) {
            localStorage.removeItem(key);
          }
          else {
            localStorage.clear();
          }
        }
      }
      
      return {
        test: test,
        store: store,
        read: read,
        destroy: destroy
      };
    
    })();

    // -->

    </script>
    <script>
      const params = {
        "autoStart": true,
        "enableCreds": true,
        "databaseId": "jPasswordGen",
        "templateId": "template",
        "templateFields": {
          "lengthId": "length",
          "lettersLowerId": "letters-lower",
          "lettersUpperId": "letters-upper",
          "numbersId": "numbers",
          "symbolsId": "symbols",
          "amountId": "amount",
        },
        "templateButtons": {
          "submitId": "button-generate",
          "resetId": "button-reset",
          "helpId": "button-help"
        },
        "saveId": "save",
        "outputId": "output",
        "helpContentId": "help"
      };
      const jPasswordGen = new main.App.init(params);
    </script>
  </body>
</html>
