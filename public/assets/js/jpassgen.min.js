(()=>{"use strict";class t{toggle(t){const e=document.querySelectorAll(t+", #"+t+", ."+t)[0];"none"===e.style.display?e.style.display="":e.style.display="none"}}class e{blur(t,e){const a=document.querySelectorAll(t+", #"+t+", ."+t)[0];a.addEventListener?a.addEventListener("blur",e):a.attachEvent&&a.attachEvent("onblur",e)}change(t,e){const a=document.querySelectorAll(t+", #"+t+", ."+t)[0];a.addEventListener?a.addEventListener("change",e):a.attachEvent&&a.attachEvent("onchange",e)}click(t,e){const a=document.querySelectorAll(t+", #"+t+", ."+t)[0];a.addEventListener?a.addEventListener("click",e):a.attachEvent&&a.attachEvent("onclick",e)}}class a{copyClip(t,e,a,s){const i=document.querySelectorAll(t+", #"+t+", ."+t)[0];i.select(),i.setSelectionRange(0,99999),navigator.clipboard.writeText(i.value),this.feedback(e,a,s)}feedback(t,e,a=1e3){const s=document.querySelectorAll(t+", #"+t+", ."+t)[0];if(s){let t=s.textContent,i=!!t;i||(t=s.value),s.disabled=!0,e&&(!0===i?s.textContent=e:s.value=e),s.focus(),setTimeout((()=>{!0===i?s.textContent=t:s.value=t,s.disabled=!1}),a)}}}class s{validate(t,e){if(!e)return!0;for(let a=0;a<e.length;a++)return t.indexOf(e.charAt(a))>=0}generate(t,e){let a="";if(t=Math.abs(parseInt(t)),Number.isInteger(t)&&e)for(let s=0;s<t;s++)a+=e.charAt(Math.floor(Math.random()*e.length));return a}}class i{constructor(t={dataArray:!0}){this.data=t,this.dataArray=this.data.dataArray}validateJSON(t){let e=!1;if(t)try{JSON.parse(t),e=!0}catch(t){}return e}validateJSONAPI(t,e=this.dataArray){let a=!1;if(this.validateJSON(t)){const s=JSON.parse(t);s.data&&(e&&Array.isArray(s.data)?"string"==typeof s.data[0].type&&"string"==typeof s.data[0].id&&"object"==typeof s.data[0].attributes&&(a=!0):e||"object"!=typeof s.data||"string"==typeof s.data.type&&"string"==typeof s.data.id&&"object"==typeof s.data.attributes&&(a=!0))}return a}}class d{constructor(t){if(this.data=t,this.database=this.data.name,this.persistence=this.data.persistence,this.cookieStorage=this.data.cookieStorage,this.reset=this.data.reset,this.JSONAPI=this.data.JSONAPI,this.persistentExpiry=36500,this.lsSupport=!1,this.schema=new i,"undefined"!=typeof Storage)try{sessionStorage.setItem("sessionStorage","true"),this.lsSupport=!0}catch(t){}this.cookieStorage&&(this.lsSupport=!1),this.reset&&(this.destroy(),this.destroyCookie())}store(t,e,a){a=this.persistence?this.persistentExpiry:a,this.lsSupport?a&&a>0?localStorage.setItem(t,e):sessionStorage.setItem(t,e):a?this.storeCookie(t,e,a):this.storeCookie(t,e)}storeField(t,e,a){let s=this.read(this.database),i=this.JSONAPI?{data:[{type:this.JSONAPI.type,id:this.JSONAPI.id,attributes:{}}]}:{},d=this.schema.validateJSON(s)?JSON.parse(s):i;this.JSONAPI?d.data[0].attributes[t]=e:d[t]=e,d=JSON.stringify(d),this.store(this.database,d,a)}read(t){return this.lsSupport?localStorage.getItem(t)?localStorage.getItem(t):sessionStorage.getItem(t)?sessionStorage.getItem(t):void 0:this.readCookie(t)?this.readCookie(t):void 0}readField(t){let e=this.read(this.database);return this.schema.validateJSON(e)?this.JSONAPI?JSON.parse(e).data[0].attributes[t]:JSON.parse(e)[t]:e}destroy(t){this.lsSupport?t?(localStorage.removeItem(t),sessionStorage.removeItem(t)):(localStorage.clear(),sessionStorage.clear()):this.destroyCookie(t)}destroyField(t){if(t){let e=this.read(this.database);if(this.schema.validateJSON(e)){let a=JSON.parse(e);this.JSONAPI?delete a.data[0].attributes[t]:delete a[t],a=JSON.stringify(a),sessionStorage.getItem(this.database)?this.store(this.database,a):(localStorage.getItem(this.database),this.store(this.database,a,this.persistentExpiry))}else this.destroy(t)}else this.destroy()}storeCookie(t,e,a){e=encodeURIComponent(e);let s=new Date;s.setTime(s.getTime()+24*a*60*60*1e3);let i="; expires="+s.toGMTString();document.cookie=t+"="+e+i+"; path=/"}readCookie(t){const e=document.cookie.split(";").reduce(((t,e)=>{const[a,s]=e.split("=").map((t=>t.trim()));return a&&s&&(t[a]=decodeURIComponent(s)),t}),{});return t?e[t]||"":e}destroyCookie(t){if(t)this.storeCookie(t,"",-1);else{const t=document.cookie.split(";");for(let e of t){let t=e.indexOf("="),a=t>-1?e.substring(0,t):e;document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}}}}class o{constructor(i){this.data=i.data[0].attributes,this.effects=new t,this.events=new e,this.interaction=new a,this.jPassGen=new s,this.localData=new d(this.data.localData)}render(){if(this.data){if(document.body.innerHTML=document.getElementById(this.data.templateId).innerHTML,this.events.click(this.data.templateButtons.submitId,(()=>{this.gen()})),this.events.click(this.data.templateButtons.copyId,(()=>{this.interaction.copyClip(this.data.outputId,this.data.templateButtons.copyId,"Copied")})),this.events.click(this.data.templateButtons.resetId,(()=>{this.reset()})),!0===this.data.enableHelp&&(document.getElementById(this.data.helpContentId).style.display="none",this.events.click(this.data.templateButtons.helpId,(()=>{this.effects.toggle(this.data.helpContentId)}))),this.localData.readField(this.data.saveId)){let t,e=Object.values(this.data.templateFields);for(let a of e)t=this.localData.readField(a),"undefined"!==t&&(document.getElementById(a).value=t);document.getElementById(this.data.saveId).checked=!0}if(!0===this.data.autoStart&&this.gen(),!0===this.data.enableCreds){try{document.getElementById("description").innerHTML=document.getElementsByName("description")[0].getAttribute("content")}catch(t){}try{document.getElementById("author").innerHTML=document.getElementsByName("author")[0].getAttribute("content")}catch(t){}}}}removeSpaces(t){return t?t.replace(/\s/g,""):""}reset(){let t=Object.values(this.data.templateFields);for(let e of t)this.localData.destroyField(e),document.getElementById(e).value=document.getElementById(e).defaultValue;this.localData.destroyField(this.data.saveId),document.getElementById(this.data.saveId).checked=document.getElementById(this.data.saveId).defaultChecked,document.getElementById(this.data.outputId).value=document.getElementById(this.data.outputId).defaultValue,document.getElementById(this.data.templateButtons.submitId).focus()}gen(){let t="",e="",a=document.getElementById(this.data.templateFields.lengthId).value,s=document.getElementById(this.data.templateFields.lettersLowerId).value,i=document.getElementById(this.data.templateFields.lettersUpperId).value,d=document.getElementById(this.data.templateFields.numbersId).value,o=document.getElementById(this.data.templateFields.symbolsId).value,l=document.getElementById(this.data.templateFields.amountId).value,n=document.getElementById(this.data.saveId).checked;if(a>=5&&(""!==s||""!==i||""!==d||""!==o)&&l>=1){s=this.removeSpaces(s),i=this.removeSpaces(i),d=this.removeSpaces(d),o=this.removeSpaces(o);let r=s+i+d+o;for(let n=0;n<l;n++){for(t=this.jPassGen.generate(a,r);!1===this.jPassGen.validate(t,s)||!1===this.jPassGen.validate(t,i)||!1===this.jPassGen.validate(t,d)||!1===this.jPassGen.validate(t,o);)t=this.jPassGen.generate(a,r);e=0===n?t:e+="\r"+t}if(!0===n){let t=Object.values(this.data.templateFields);for(let e of t)this.localData.storeField(e,document.getElementById(e).value);this.localData.storeField(this.data.saveId,n)}}else alert("Error: One or more fields contains an invalid value.");document.getElementById(this.data.outputId).value=e,document.getElementById(this.data.outputId).select()}}(new class{async load(){let t=await fetch("assets/api/config.json");if(200===t.status){let e=await t.json();new o(e).render()}}}).load()})();