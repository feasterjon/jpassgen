(()=>{"use strict";class t{toggle(t){const e=document.getElementById(t);"none"===e.style.display?e.style.display="":e.style.display="none"}}class e{change(t,e){const a=document.getElementById(t);a.addEventListener?a.addEventListener("change",e):a.attachEvent&&a.attachEvent("onchange",e)}click(t,e){const a=document.getElementById(t);a.addEventListener?a.addEventListener("click",e):a.attachEvent&&a.attachEvent("onclick",e)}}class a{copyClip(t,e){const a=document.getElementById(t);if(a.select(),a.setSelectionRange(0,99999),navigator.clipboard.writeText(a.value),void 0!==e){const t=document.getElementById(e),a=t.innerHTML;t.disabled=!0,t.innerHTML="Copied!",t.focus(),setTimeout((function(){t.innerHTML=a,t.disabled=!1}),1e3)}}}class s{validate(t,e){let a=!1;if(""!==e){let s=e.length;for(let l=0;l<s;l++)if(t.indexOf(e.charAt(l))>=0){a=!0;break}}else a=!0;return a}generate(t,e){let a="";if(t=Math.abs(parseInt(t)),Number.isInteger(t)&&""!==e)for(let s=0;s<t;s++)a+=e.charAt(Math.floor(Math.random()*e.length));return a}}class l{constructor(){if(this.lsSupport=!1,"undefined"!=typeof Storage)try{sessionStorage.setItem("sessionStorage","true"),this.lsSupport=!0}catch(t){}}store(t,e,a){!0===this.lsSupport?a?sessionStorage.setItem(t,e):localStorage.setItem(t,e):a?this.storeCookie(t,e,a):this.storeCookie(t,e)}read(t){return!0!==this.lsSupport?this.readCookie(t):sessionStorage.getItem(t)?sessionStorage.getItem(t):localStorage.getItem(t)?localStorage.getItem(t):void 0}destroy(t){!0===this.lsSupport?t?localStorage.removeItem(t):localStorage.clear():t?this.storeCookie(t,"",-1):this.destroyCookies()}storeCookie(t,e,a){let s=new Date;s.setTime(s.getTime()+24*a*60*60*1e3);let l="; expires="+s.toGMTString();document.cookie=t+"="+e+l+"; path=/"}readCookie(t){let e=t+"=",a=document.cookie.split(";");for(let t=0,s=a.length;t<s;t++){let s=a[t];for(;" "===s.charAt(0);)s=s.substring(1,s.length);if(0===s.indexOf(e))return s.substring(e.length,s.length)}return null}destroyCookies(){let t=document.cookie.split(";"),e=t.length;for(let a=0;a<e;a++){let e=t[a],s=e.indexOf("="),l=s>-1?e.substr(0,s):e;document.cookie=l+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}}}const n=new class{constructor(){this.data={autoStart:!0,enableCreds:!0,enableHelp:!0,localDB:"JPassGen",templateId:"template",saveId:"flexSwitchCheckChecked",outputId:"output",helpContentId:"help",templateFields:{lengthId:"length",lettersLowerId:"letters-lower",lettersUpperId:"letters-upper",numbersId:"numbers",symbolsId:"symbols",amountId:"amount"},templateButtons:{submitId:"button-generate",copyId:"button-copy",resetId:"button-reset",helpId:"button-help"}}}},o=new class{constructor(n){this.data=n.data,this.effects=new t,this.events=new e,this.interaction=new a,this.jPassGen=new s,this.localData=new l}mount(){if(void 0!==this.data){if(document.body.innerHTML=document.getElementById(this.data.templateId).innerHTML,this.events.click(this.data.templateButtons.submitId,(()=>{this.gen()})),this.events.click(this.data.templateButtons.copyId,(()=>{this.interaction.copyClip(this.data.outputId,this.data.templateButtons.copyId)})),this.events.click(this.data.templateButtons.resetId,(()=>{this.reset()})),!0===this.data.enableHelp&&(document.getElementById(this.data.helpContentId).style.display="none",this.events.click(this.data.templateButtons.helpId,(()=>{this.effects.toggle(this.data.helpContentId)}))),void 0!==this.localData.read(this.data.localDB+"-"+this.data.saveId)){let t,e=Object.values(this.data.templateFields);for(let a of e)t=this.localData.read(this.data.localDB+"-"+a),void 0!==t&&(document.getElementById(a).value=t);document.getElementById(this.data.saveId).checked=!0}if(!0===this.data.autoStart&&this.gen(),!0===this.data.enableCreds){try{document.getElementById("description").innerHTML=document.getElementsByName("description")[0].getAttribute("content")}catch(t){}try{document.getElementById("author").innerHTML=document.getElementsByName("author")[0].getAttribute("content")}catch(t){}}}}removeSpaces(t){let e="";return t&&(e=t.replace(/\s/g,"")),e}reset(){let t=Object.values(this.data.templateFields);for(let e of t)this.localData.destroy(this.data.localDB+"-"+e),document.getElementById(e).value=document.getElementById(e).defaultValue;this.localData.destroy(this.data.localDB+"-"+this.data.saveId),document.getElementById(this.data.saveId).checked=document.getElementById(this.data.saveId).defaultChecked,document.getElementById(this.data.outputId).value=document.getElementById(this.data.outputId).defaultValue,document.getElementById(this.data.templateButtons.submitId).focus()}gen(){let t="",e="",a=document.getElementById(this.data.templateFields.lengthId).value,s=document.getElementById(this.data.templateFields.lettersLowerId).value,l=document.getElementById(this.data.templateFields.lettersUpperId).value,n=document.getElementById(this.data.templateFields.numbersId).value,o=document.getElementById(this.data.templateFields.symbolsId).value,d=document.getElementById(this.data.templateFields.amountId).value,i=document.getElementById(this.data.saveId).checked;if(a>=5&&(""!==s||""!==l||""!==n||""!==o)&&d>=1){s=this.removeSpaces(s),l=this.removeSpaces(l),n=this.removeSpaces(n),o=this.removeSpaces(o);let c=s+l+n+o;for(let i=0;i<d;i++){for(t=this.jPassGen.generate(a,c);!1===this.jPassGen.validate(t,s)||!1===this.jPassGen.validate(t,l)||!1===this.jPassGen.validate(t,n)||!1===this.jPassGen.validate(t,o);)t=this.jPassGen.generate(a,c);0===i?e=t:e+="\r"+t}if(!0===i){let t=Object.values(this.data.templateFields);for(let e of t)this.localData.store(this.data.localDB+"-"+e,document.getElementById(e).value);this.localData.store(this.data.localDB+"-"+this.data.saveId,i)}}else alert("Error: One or more fields contains an invalid value.");document.getElementById(this.data.outputId).value=e,document.getElementById(this.data.outputId).select()}}(n);o.mount()})();